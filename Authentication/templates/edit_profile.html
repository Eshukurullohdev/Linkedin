{% extends 'base.html' %}
{% block content %}
<div class="max-w-2xl mx-auto bg-white p-8 mt-10 shadow-md rounded-lg">
  <h2 class="text-2xl font-semibold text-gray-800 mb-6">Edit Profile</h2>
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.as_p }}
    <div class="p-4">
      <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition">Save
        Changes <i class="fa-solid fa-floppy-disk ml-2"></i></button>
      <a href="{% url 'profile' %}" class="ml-4 text-gray-600 hover:text-gray-800">Cansel</a>
    </div>
  </form>
</div>

<form id="photo-form" method="POST" enctype="multipart/form-data" action="{% url 'update_photo' %}">
  {% csrf_token %}
  <img id="user-photo" src="{{ request.user.userprofile.photo.url }}" alt="Profil rasmi" width="150" height="150" style="border-radius: 50%; object-fit: cover;">
  <label for="photo-input" style="font-size: 36px; cursor: pointer;">âž•</label>
  <input type="file" id="photo-input" name="photo" accept="image/*" style="display: none;">
</form>

<script>
  document.getElementById('photo-input').addEventListener('change', function () {
    document.getElementById('photo-form').submit();
  });
</script>

{% endblock %}